# SSH config for BNL (Campus)

{{- $campus_workstation := trim (onepasswordRead "op://Work/BNL Internal Details/Computers/Campus Workstation") -}}
{{ "" }}

Host ssh.bnl.gov
	ForwardAgent yes
    # Can authenticate by pubkey to gateways
  	PubKeyAuthentication yes
  	# Can't authenticate by Kerberos to BNL ITD gateways
  	GSSAPIAuthentication no

#
# Office Workstation
#
Match Host {{ $campus_workstation }} !exec "host -W 1 %h"
	ProxyJump ssh.bnl.gov
	ForwardAgent yes
	DynamicForward {{ trim (onepasswordRead "op://Work/BNL Internal Details/Ports/campus-socks-port") }}

Host {{ $campus_workstation }}
	Hostname {{ $campus_workstation }}
	ForwardAgent yes
